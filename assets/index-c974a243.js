import{d as E,a0 as L,r as g,a1 as O,c as w,R as K,a2 as P,o as W,e as X,w as D,U as j,b as q,n as G,W as a,i as I,m as $,X as J,an as Q,x as Z}from"./index-f159d33e.js";import{Y as ee}from"./index-1d568754.js";import{I as te}from"./index-acd93f07.js";import{I as ne}from"./index-61050c99.js";import{u as ae}from"./use-form-item-ab48ac88.js";const R=(s,i,u)=>{if(Number.isInteger(s)&&Number.isInteger(i)){const n=s+i;if(u===0)return n}const r=s.toString().split(".")[1]??"",l=i.toString().split(".")[1]??"",m=10**Math.max(r.length??0,l.length??0);return(s*m+i*m)/m},se=(s,i)=>{if(!s||Number.isNaN(s))return 0;const u=s.toString().split("."),r=u[0];let l=u[1]??"";return l.length>i?(l=l.slice(0,i),+`${r}.${l}`):s},oe=/[-]?(\d*\.\d+|\d+\.\d|\d+)/,ue=250,le=60,ie=E({name:"YkInputNumber",__name:"input-number",props:{modelValue:{},max:{default:1/0},min:{default:-1/0},step:{default:1},precision:{default:0},size:{default:"l"},disabled:{type:Boolean,default:!1},message:{},controls:{type:Boolean,default:!0},formatter:{type:Function,default:s=>s}},emits:["update:modelValue","increase","decrease"],setup(s,{emit:i}){const u=s,r=L("input-number"),l=i,v=g(!1),m=g(!1),n=O(u),t=g(0),_=g(),{disabled:F,size:Y}=n,{mergedSize:f,mergedDisabled:M}=ae({disabled:F,size:Y});let c;const d=w(()=>{let e=n.precision.value;return(!Number.isInteger(e)||e>20)&&(e=0),e}),h=()=>u.max===1/0&&u.min===-1/0?0:u.min;let y,x;const B=e=>{if(u.disabled)return;const o=e===1?k:z;window.addEventListener("mouseup",p),y=window.setTimeout(()=>{x=window.setInterval(()=>{o()},le)},ue)},p=()=>{y&&clearTimeout(y),x&&clearInterval(x),window.removeEventListener("mouseup",p)},N=w(()=>t.value<=n.min.value),V=w(()=>t.value>=n.max.value);K(()=>{var e;t.value=((e=n.modelValue)==null?void 0:e.value)??h()});const k=()=>{if(V.value){p();return}c=R(t.value,n.step.value,d.value),t.value=c>=n.max.value?n.max.value:c,b(),l("increase")},z=()=>{if(N.value){p();return}c=R(t.value,-n.step.value,d.value),t.value=c<=n.min.value?n.min.value:c,b(),l("decrease")},A=e=>{e.key==="ArrowUp"&&k(),e.key==="ArrowDown"&&z()},H=()=>{b()},T=()=>{m.value=!0},U=e=>{var o;t.value=e?Number((e.match(oe)??["0"])[0]):0,d.value===0?t.value=Math.trunc(t.value):t.value=se(t.value,d.value),V.value&&(t.value=n.max.value),N.value&&(t.value=n.min.value),b(),m.value=!1,(o=_.value)==null||o.setValue(S.value)},b=()=>{l("update:modelValue",t.value)},S=w(()=>{const e=t.value.toFixed(d.value);return m.value?e:n.formatter.value(e)??e});return P(()=>u.modelValue,e=>{t.value=e??h()}),(e,o)=>(W(),X(a(ee),Q({ref_key:"inputRef",ref:_,"model-value":S.value,disabled:a(M),size:a(f),class:a(r)()},e.$attrs,{onFocus:T,onChange:H,onBlur:U,onHoverin:o[2]||(o[2]=C=>v.value=!0),onHoverout:o[3]||(o[3]=C=>v.value=!1),onKeydown:A}),{suffix:D(()=>[j(q("div",{class:G([a(r)("buttons"),a(r)([a(f)])])},[I(a($),{disabled:V.value,size:a(f),type:"secondary",onClick:k,onMousedown:o[0]||(o[0]=C=>B(1))},{default:D(()=>[I(a(te))]),_:1},8,["disabled","size"]),I(a($),{disabled:N.value,size:a(f),type:"secondary",onClick:z,onMousedown:o[1]||(o[1]=C=>B(0))},{default:D(()=>[I(a(ne))]),_:1},8,["disabled","size"])],2),[[J,e.controls&&!a(M)&&v.value]])]),_:1},16,["model-value","disabled","size","class"]))}}),re=Z(ie),pe=re;export{pe as _};
