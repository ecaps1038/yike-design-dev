import{d as N,a0 as R,ab as P,o as f,a as K,e as I,N as U,X as v,n as E,c as S,aj as j,i as F,a3 as se,f as V,b as x,t as ne,w as X,W as le,al as ee,am as oe,Z as de,p as ae,g as re,F as L,h as W,an as A,a1 as ce,ah as ie,a2 as O,ao as D,Q as G,r as ue,a5 as pe,ap as fe,Y as ye,x as he}from"./index-Du6vcQYg.js";import{Y as ve}from"./index-YlwWU4uM.js";import{a as ke,b as me,e as ge}from"./index-Cz6pHL58.js";import{I as Ke}from"./index-BAbf5ip6.js";const z=Symbol("TreeInjectionKey"),Z=Symbol("TreeNodeInjectionKey"),be=N({__name:"node-switcher",setup(i){const d=R("tree-node-switcher"),a=P(Z),t=P(z);return(e,c)=>{var u,w,m,b;return f(),K("span",{class:E(v(d)([(u=v(a))!=null&&u.expanded.value?"rotate":"",(w=v(a))!=null&&w.isLeaf?"leaf":""])),onClick:c[0]||(c[0]=$=>{var T,B,l,r;return(r=(T=v(t))==null?void 0:T.onExpand)==null?void 0:r.call(T,(B=v(a))==null?void 0:B.option.key,(l=v(a))==null?void 0:l.expanded.value)})},[(f(),I(U((b=(m=v(t))==null?void 0:m.expandIcon)==null?void 0:b.call(m))))],2)}}});function Y(i){var a;let d=[];return(a=i.children)==null||a.forEach(t=>{d.push(t.key),t.children&&t.children.length>0&&(d=d.concat(Y(t)))}),d}const _e=N({__name:"tree-node",props:{label:{},node:{}},setup(i){const d=R("tree-node"),a=i,t=S(()=>d()),e=P(z),c=P(Z),u=S(()=>{var l;return!!((l=e==null?void 0:e.selectedKeys)!=null&&l.includes(a.node.key))}),w=S(()=>d("content",[e!=null&&e.blockNode?"block":void 0,u.value?"active":void 0])),m=Object.assign({fold:()=>j(ke),unfold:()=>j(me),file:()=>j(Ke)},e==null?void 0:e.fileIcons,a.node.icons),b=S(()=>e!=null&&e.fileTree?c!=null&&c.isLeaf?m.file:c!=null&&c.expanded.value?m.unfold:m.fold:null),$=l=>{var y,h,k,_;let r=[a.node.key];if(!(e!=null&&e.checkStrictly)){const g=(y=e==null?void 0:e.nodeMaps)==null?void 0:y.get(a.node.key);if(g&&g.pKey){const p=(h=e==null?void 0:e.nodeMaps)==null?void 0:h.get(g.pKey);p&&((k=p.children)!=null&&k.every(H=>{var M,s;return(s=(M=e==null?void 0:e.checkedKeys)==null?void 0:M.concat([a.node.key]))==null?void 0:s.includes(H.key)}))&&r.push(p.key)}r.push(...Y(a.node))}(_=e==null?void 0:e.onChecked)==null||_.call(e,r,l)},T=S(()=>{var l,r;return e!=null&&e.checkStrictly?!1:((l=a.node.children)==null?void 0:l.some(y=>{var h;return(h=e==null?void 0:e.checkedKeys)==null?void 0:h.includes(y.key)}))&&!((r=a.node.children)!=null&&r.every(y=>{var h;return(h=e==null?void 0:e.checkedKeys)==null?void 0:h.includes(y.key)}))}),B=S(()=>{var l,r,y;return e!=null&&e.checkStrictly?(l=e==null?void 0:e.checkedKeys)==null?void 0:l.includes(a.node.key):((r=e==null?void 0:e.checkedKeys)==null?void 0:r.includes(a.node.key))||((y=a.node.children)==null?void 0:y.every(h=>{var k;return(k=e==null?void 0:e.checkedKeys)==null?void 0:k.includes(h.key)}))});return(l,r)=>{var y,h;return f(),K("div",{class:E(t.value)},[F(be),(y=v(e))!=null&&y.checkable?(f(),K("span",{key:0,class:E(v(d)("checkbox")),onClick:r[0]||(r[0]=se(()=>{},["stop"]))},[F(v(ve),{checked:B.value,indeterminate:T.value,onChange:$},null,8,["checked","indeterminate"])],2)):V("",!0),x("div",{class:E(w.value),onClick:r[1]||(r[1]=k=>{var _,g;return(g=(_=v(e))==null?void 0:_.onSelect)==null?void 0:g.call(_,a.node.key)})},[(h=v(e))!=null&&h.fileTree?(f(),K("span",{key:0,class:E(v(d)("file"))},[(f(),I(U(b.value)))],2)):V("",!0),x("span",null,ne(l.label),1)],2)],2)}}}),Se=N({__name:"expand-transition",setup(i){const d=R("collapse"),a=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},t={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){e.dataset.oldOverflow=e.style.overflow,e.scrollHeight!==0?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){a(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){e.scrollHeight!==0&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){a(e)},leaveCancelled(e){a(e)}};return(e,c)=>(f(),I(de,ee({name:v(d)()},oe(t)),{default:X(()=>[le(e.$slots,"default")]),_:3},16,["name"]))}}),we={key:0,class:"yk-tree__list"},J=N({__name:"node",props:{option:{}},setup(i){const d=i,a=P(z),t=S(()=>{var u;return!!((u=a==null?void 0:a.expandedKeys)!=null&&u.includes(d.option.key))}),e=S(()=>t.value&&!c.value),c=S(()=>!d.option.children||!d.option.children.length);return ae(Z,{option:d.option,isLeaf:c.value,expanded:t}),(u,w)=>{const m=re("node",!0);return f(),K(L,null,[F(_e,{label:u.option.label,node:u.option},null,8,["label","node"]),F(Se,null,{default:X(()=>[e.value?(f(),K("div",we,[(f(!0),K(L,null,W(u.option.children,b=>(f(),I(m,{key:b.key,option:b},null,8,["option"]))),128))])):V("",!0)]),_:1})],64)}}}),Q=(i,d)=>{const a=new Map;return i&&i.length===0||i==null||i.forEach(t=>{a.set(t.key,{...t,pKey:d});for(const[e,c]of Q(t.children,t.key))a.set(e,c)}),a},Te=N({name:"YkTree",__name:"tree",props:A({options:{},blockNode:{type:Boolean,default:!1},defaultExpandedKeys:{default(){return[]}},expandedKeys:{},selectedKeys:{},defaultSelectedKeys:{default(){return[]}},multiple:{type:Boolean,default:!1},expandIcon:{type:Function,default(){return()=>j(ge)}},fileTree:{type:Boolean,default:!1},fileIcons:{},checkable:{type:Boolean,default:!1},checkedKeys:{},checkStrategy:{default:"all"},checkStrictly:{type:Boolean,default:!1},scrollbar:{default:!1},unSelectKey:{}},{expandedKeys:{local:!0,default:[]},expandedKeysModifiers:{},selectedKeys:{local:!0,default:[]},selectedKeysModifiers:{},checkedKeys:{default:[],local:!0},checkedKeysModifiers:{}}),emits:A(["expand","select","check"],["update:expandedKeys","update:selectedKeys","update:checkedKeys"]),setup(i,{emit:d}){const a=R("tree"),t=i,e=d,{checkStrictly:c,checkStrategy:u,checkable:w,fileIcons:m,fileTree:b,blockNode:$,expandIcon:T,unSelectKey:B}=ce(t),l=ie(Q(t.options));O(()=>t.options,()=>{l.value=Q(t.options)});const r=D(i,"expandedKeys"),y=s=>{var n;h(s,!1,!0);const o=(n=l.value.get(s))==null?void 0:n.pKey;o&&y(o)};G(()=>{if(t.defaultExpandedKeys.length!==0)for(const s of t.defaultExpandedKeys)y(s)});const h=(s,o=!1,n=!1)=>{const C=new Set([...r.value]);o?C.delete(s):C.add(s),r.value=[...C],!n&&e("expand",r.value)},k=D(i,"selectedKeys");G(()=>{var s;if(t.defaultSelectedKeys.length!==0){k.value=t.defaultSelectedKeys;for(const o of t.defaultSelectedKeys){const n=(s=l.value.get(o))==null?void 0:s.pKey;n&&y(n)}}});const _=s=>{t.multiple?k.value=[...new Set([...k.value,s])]:k.value=[s],e("select",k.value)};O(()=>B==null?void 0:B.value,s=>{k.value=k.value.filter(o=>o!=s),w.value&&M([s],!1)});const g=D(i,"checkedKeys"),p=ue([]);p.value=[...g.value],O(c,s=>{if(s)H();else{let o=[];p.value.forEach(n=>{const C=l.value.get(n);if(!C)return;const te=Y(C);o.push(n),te.forEach(q=>{o.includes(q)||o.push(q)})}),p.value=[...new Set(o)]}},{immediate:!0});const H=()=>{if(u.value==="all"||c.value){g.value=[...p.value];return}const s=[];p.value.forEach(o=>{if(!l.value.has(o))return;const n=Y(l.value.get(o));if(n&&n.length>0&&n.every(C=>p.value.includes(C))){s.push(o);return}}),u.value==="parent"&&(g.value=p.value.filter(o=>{const n=l.value.get(o);return!(n&&n.pKey&&s.includes(n.pKey))})),u.value==="child"&&(g.value=p.value.filter(o=>!s.includes(o)))};O(p,H,{deep:!0,immediate:!0}),O(u,H);const M=(s,o)=>{o?p.value.push(...s):p.value=p.value.filter(n=>!s.includes(n))};return ae(z,pe({blockNode:$,expandedKeys:r,selectedKeys:k,checkedKeys:p,fileTree:b,fileIcons:m,checkable:w,checkStrategy:u,checkStrictly:c,expandIcon:T,nodeMaps:l,onSelect:_,onExpand:h,onChecked:M})),(s,o)=>(f(),K("div",{class:E(v(a)())},[t.scrollbar?(f(),I(v(ye),fe(ee({key:0},t.scrollbar)),{default:X(()=>[(f(!0),K(L,null,W(s.options,n=>(f(),I(J,{key:n.key,option:n},null,8,["option"]))),128))]),_:1},16)):(f(!0),K(L,{key:1},W(s.options,n=>(f(),I(J,{key:n.key,option:n},null,8,["option"]))),128))],2))}}),He=he(Te);export{He as Y};
