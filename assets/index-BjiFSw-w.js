import{r as g,c as b,a1 as q,a2 as B,d as G,a0 as Q,a5 as U,Q as H,o as y,e as Z,i as f,w as x,U as J,V as oe,a as _,b as u,n as v,X as o,v as S,I as se,f as w,F as A,au as M,t as N,Z as ae,a7 as ne,al as le,W as D,h as re,s as ie,x as F}from"./index-Du6vcQYg.js";import{Y}from"./index-CTx81IFy.js";import{I as ce}from"./index-CgJPdHP5.js";import{I as ue}from"./index-Dw2JN53_.js";import{b as de,c as ve,d as pe,e as fe,a as me}from"./index-BAx8txvw.js";const be=(a,t)=>{const e={};for(const n of t)n in a&&a[n]&&(e[n]=a[n]);return e},W=a=>{if(a===void 0)return;if(typeof a=="string"&&/^\d+(%)$/.test(a))return a;const t=parseInt(a,10);return typeof t=="number"?`${t}px`:void 0},ge=a=>(a*100).toFixed(0)+"%",ye=a=>a?typeof a=="string"?document.querySelector(a):a:document.body,he={mounted(a,t){const e=new IntersectionObserver(n=>{n[0].isIntersecting?t.value(!0):t.value(!1)});e.observe(a),a._observer=e},unmounted(a){a._observer&&(a._observer.disconnect(),delete a._observer)}},ke=a=>{const t=g("beforeLoad"),e=b(()=>t.value==="beforeLoad"),n=b(()=>t.value==="loading"),s=b(()=>t.value==="error"),r=b(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:n,isError:s,isLoaded:r,setLoadStatus:c=>{t.value=c}}},Ce=a=>{const{imageEl:t,scale:e}=q(a),n=g([0,0]);let s=!1,r,c,p=0,i=0;const m=d=>{s=!0,d.preventDefault&&d.preventDefault(),r=d.clientX,c=d.clientY,document.addEventListener("mousemove",k),document.addEventListener("mouseup",I)},k=d=>{if(s===!1)return;d.preventDefault&&d.preventDefault();const L=(d.clientX-r)/e.value+p,l=(d.clientY-c)/e.value+i;n.value=[L,l]},I=d=>{s!==!1&&(d.preventDefault&&d.preventDefault(),s=!1,p=n.value[0],i=n.value[1],document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",I))};return B(t,()=>{t.value.addEventListener("mousedown",m)}),{translate:n,resetTranslate:()=>{p=0,i=0,n.value=[p,i]}}},Ie=a=>{const{wrapperEl:t}=q(a),e=.1,n=.1,s=10,r=g(1),c=(i="zoomIn",m=e)=>{const k=i==="zoomIn"?m:-m;r.value+=k,r.value=Math.min(Math.max(r.value,n),s)},p=i=>{i.deltaY>0?c("zoomOut",.5):i.deltaY<0&&c("zoomIn",.5)};return B(t,()=>{t.value&&t.value.addEventListener("wheel",p)}),{scale:r,adjustZoom:c,resetScale:()=>{r.value=1}}},we=["src"],X=90,K=G({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(a,{emit:t}){const e=a,n=t,s=Q("image-preview"),r=g(e.visible),c=g(0),p=g(),i=g(),{scale:m,resetScale:k,adjustZoom:I}=Ie(U({wrapperEl:i})),{translate:d,resetTranslate:L}=Ce(U({imageEl:p,scale:m})),l=g();H(()=>l.value=ye(e.popupContainer));const E=b(()=>l.value===document.body),O=b(()=>({...E.value?{zIndex:M.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));B(()=>e.visible,C=>{!C&&e.unmountOnClose?r.value=!1:r.value=!0,l.value&&(C?l.value.style.overflow="hidden":l.value.style.overflow="")});const $=()=>{var C;n("update:visible",!1),(C=e.onCancel)==null||C.call(e)},z=C=>{e.maskClosable&&C.target===C.currentTarget&&$()},T=()=>{c.value=c.value===0?360-X:c.value-X},h=()=>{c.value=(c.value+X)%360},P=()=>{I("zoomIn")},V=()=>{I("zoomOut")},ee=()=>{k(),L()};return(C,R)=>(y(),Z(ne,{to:l.value,disabled:!l.value},[f(ae,{name:"preview-fade"},{default:x(()=>[r.value?J((y(),_("div",{key:0,ref_key:"wrapperRef",ref:i,class:v(o(s)()),style:S(O.value)},[u("div",{class:v(o(s)("mask")),onClick:z},null,2),u("div",{class:v(o(s)("body")),style:S({transform:`scale(${o(m)}, ${o(m)})`}),onClick:z},[u("img",{ref_key:"imageRef",ref:p,src:e.src,class:v(o(s)("img")),style:S({transform:`rotate(${c.value}deg) translate(${o(d)[0]}px, ${o(d)[1]}px)`})},null,14,we)],6),e.closable?(y(),_("button",{key:0,class:v(o(s)("close-btn")),onClick:$},[f(o(se))],2)):w("",!0),e.previewGroup?(y(),_(A,{key:1},[u("button",{class:v(o(s)("arrow-left")),style:S({zIndex:o(M).nextIndex()}),onClick:R[0]||(R[0]=te=>n("onPrev"))},[f(o(ce))],6),u("button",{class:v(o(s)("arrow-right")),style:S({zIndex:o(M).nextIndex()}),onClick:R[1]||(R[1]=te=>n("onNext"))},[f(o(ue))],6)],64)):w("",!0),u("div",{class:v(o(s)("toolbar")),style:S({zIndex:o(M).nextIndex()})},[f(o(Y),{placement:"top",title:"向左旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(s)("toolbar-btn")),onClick:T},[f(o(de))],2)]),_:1}),f(o(Y),{placement:"top",title:"向右旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(s)("toolbar-btn")),onClick:h},[f(o(ve))],2)]),_:1}),f(o(Y),{placement:"top",title:"放大","close-delay":0},{default:x(()=>[u("button",{class:v(o(s)("toolbar-btn")),onClick:P},[f(o(pe))],2)]),_:1}),f(o(Y),{placement:"top",title:"缩小","close-delay":0},{default:x(()=>[u("button",{class:v(o(s)("toolbar-btn")),onClick:V},[f(o(fe))],2)]),_:1}),f(o(Y),{placement:"top",title:"原始比例","close-delay":0},{default:x(()=>[u("button",{class:v(o(s)("toolbar-btn")),style:{width:"50px"},onClick:ee},[u("span",null,N(o(ge)(o(m))),1)],2)]),_:1})],6)],6)),[[oe,e.visible]]):w("",!0)]),_:1})],8,["to","disabled"]))}}),_e=["src"],Le={class:"icon"},xe={key:0,class:"alt"},Se={class:"title"},Ee={class:"description"},Oe=G({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(a){const t=a,e=Q("image"),n=g(!1),s=g(),{isLoaded:r,isError:c,isLoading:p,setLoadStatus:i}=ke(),m=b(()=>[e(),{[`${e("with-error")}`]:c.value,[`${e("with-loading")}`]:p.value}]),k=b(()=>[e("footer",[t.footerPosition])]),I=b(()=>be(t,["width","height","title","alt"])),d=b(()=>t.fit?{objectFit:t.fit}:{}),L=b(()=>({width:W(t.width),height:l.value?void 0:W(t.height)})),l=b(()=>t.title||t.description),E=g(!1),O=h=>{t.isLazy?!s.value&&h&&(s.value=t.src):s.value=t.src,E.value=h};B(()=>t.src,h=>{i("loading"),E.value&&(s.value=h),t.isLazy&&!E.value&&(s.value="")});const $=()=>i("loaded"),z=()=>i("error"),T=()=>{t.preview&&(n.value=!0)};return H(()=>{i("loading")}),(h,P)=>J((y(),_("div",{class:v(m.value),style:S(L.value)},[u("img",le({class:o(e)("img"),style:d.value,src:s.value},I.value,{onLoad:$,onError:z,onClick:T}),null,16,_e),o(r)?w("",!0):(y(),_("div",{key:0,class:v(o(e)("overlay-container"))},[o(c)?D(h.$slots,"error",{key:0},()=>[u("div",{class:v(o(e)("overlay",["error"]))},[u("div",Le,[D(h.$slots,"error-icon",{},()=>[f(o(me))])]),t.alt?(y(),_("div",xe,N(t.alt),1)):w("",!0)],2)]):w("",!0),o(p)?D(h.$slots,"loading",{key:1},()=>[u("div",{class:v(o(e)("overlay",["loading"]))},null,2)]):w("",!0)],2)),l.value?(y(),_("div",{key:1,class:v(k.value)},[u("div",null,[u("div",Se,N(t.title),1),u("div",Ee,N(t.description),1)]),u("div",null,[D(h.$slots,"extra")])],2)):w("",!0),f(K,{visible:n.value,"onUpdate:visible":P[0]||(P[0]=V=>n.value=V),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[o(he),O]])}}),j=(a,t,e)=>{const n=g(a);return a!==void 0?n.value=a:n.value=t,[n,r=>{n.value=r,e==null||e(r)}]},$e=G({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(a,{emit:t}){const e=a,n=t,[s,r]=j(e.defaultCurrent,e.current,l=>n("update:current",l)),[c,p]=j(e.visible,!1,l=>n("update:visible",l)),i=b(()=>{var l;return(l=e.srcList)==null?void 0:l.length}),m=b(()=>{if(e.srcList&&e.srcList.length)return e.srcList[s.value]});B(()=>e.visible,l=>p(l)),B(()=>e.current,l=>r(l));const k=l=>{r(l),p(!0)},I=()=>{var l;p(!1),(l=e.onCancel)==null||l.call(e)},d=()=>{i.value&&(s.value>=i.value-1?s.value=0:s.value++)},L=()=>{i.value&&(s.value<=0?s.value=i.value-1:s.value--)};return(l,E)=>(y(),_(A,null,[e.isRender?(y(),Z(o(ie),{key:0},{default:x(()=>[(y(!0),_(A,null,re(e.srcList,(O,$)=>(y(),Z(o(Be),{key:O,src:O,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>k($)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):w("",!0),f(o(Ye),{visible:o(c),src:m.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:d,onOnPrev:L,onCancel:I},null,8,["visible","src","closable","mask-closable"])],64))}}),Be=F(Oe),Ye=F(K),Ne=F($e);export{Ne as Y,Be as a,Ye as b};
