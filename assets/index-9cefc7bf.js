import{r as b,c as g,a1 as q,a2 as B,d as G,a0 as H,a5 as U,R as J,aw as M,o as y,e as Z,i as m,w as x,U as K,a as I,n as v,W as o,v as S,b as u,y as oe,f as C,F as A,t as N,X as se,Z as ne,a9 as ae,an as le,V as D,h as re,s as ie,x as F}from"./index-f159d33e.js";import{Y}from"./index-61e83363.js";import{I as ce}from"./index-5cf6288e.js";import{_ as ue}from"./index-6266b2eb.js";import{a as de,b as ve,c as pe,d as me,I as fe}from"./index-8d1ccba2.js";const ge=(s,t)=>{const e={};for(const a of t)a in s&&s[a]&&(e[a]=s[a]);return e},W=s=>{if(s===void 0)return;if(typeof s=="string"&&/^\d+(%)$/.test(s))return s;const t=parseInt(s,10);return typeof t=="number"?`${t}px`:void 0},be=s=>(s*100).toFixed(0)+"%",ye=s=>s?typeof s=="string"?document.querySelector(s):s:document.body,he={mounted(s,t){const e=new IntersectionObserver(a=>{a[0].isIntersecting?t.value(!0):t.value(!1)});e.observe(s),s._observer=e},unmounted(s){s._observer&&(s._observer.disconnect(),delete s._observer)}},_e=s=>{const t=b(s||"beforeLoad"),e=g(()=>t.value==="beforeLoad"),a=g(()=>t.value==="loading"),n=g(()=>t.value==="error"),r=g(()=>t.value==="loaded");return{status:t,isBeforeLoad:e,isLoading:a,isError:n,isLoaded:r,setLoadStatus:c=>{t.value=c}}},we=_e,ke=s=>{const{imageEl:t,scale:e}=q(s),a=b([0,0]);let n=!1,r,c,p=0,i=0;const f=d=>{n=!0,d.preventDefault&&d.preventDefault(),r=d.clientX,c=d.clientY,document.addEventListener("mousemove",_),document.addEventListener("mouseup",k)},_=d=>{if(n===!1)return;d.preventDefault&&d.preventDefault();const L=(d.clientX-r)/e.value+p,l=(d.clientY-c)/e.value+i;a.value=[L,l]},k=d=>{n!==!1&&(d.preventDefault&&d.preventDefault(),n=!1,p=a.value[0],i=a.value[1],document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",k))};return B(t,()=>{t.value.addEventListener("mousedown",f)}),{translate:a,resetTranslate:()=>{p=0,i=0,a.value=[p,i]}}},Ce=s=>{const{wrapperEl:t}=q(s),e=.1,a=.1,n=10,r=b(1),c=(i="zoomIn",f=e)=>{const _=i==="zoomIn"?f:-f;r.value+=_,r.value=Math.min(Math.max(r.value,a),n)},p=i=>{i.deltaY>0?c("zoomOut",.5):i.deltaY<0&&c("zoomIn",.5)};return B(t,()=>{t.value&&t.value.addEventListener("wheel",p)}),{scale:r,adjustZoom:c,resetScale:()=>{r.value=1}}},Ie=["src"],X=90,Q=G({name:"YkImagePreview",__name:"preview",props:{visible:{type:Boolean},src:{},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},previewGroup:{type:Boolean,default:!1},popupContainer:{},unmountOnClose:{type:Boolean,default:!1},onCancel:{}},emits:["update:visible","onNext","onPrev"],setup(s,{emit:t}){const e=s,a=t,n=H("image-preview"),r=b(e.visible),c=b(0),p=b(),i=b(),{scale:f,resetScale:_,adjustZoom:k}=Ce(U({wrapperEl:i})),{translate:d,resetTranslate:L}=ke(U({imageEl:p,scale:f})),l=b();J(()=>l.value=ye(e.popupContainer));const E=g(()=>l.value===document.body),O=g(()=>({...E.value?{zIndex:M.nextIndex()}:{zIndex:"inherit",position:"absolute",height:"100%"}}));B(()=>e.visible,w=>{!w&&e.unmountOnClose?r.value=!1:r.value=!0,l.value&&(w?l.value.style.overflow="hidden":l.value.style.overflow="")});const $=()=>{var w;a("update:visible",!1),(w=e.onCancel)==null||w.call(e)},z=w=>{e.maskClosable&&w.target===w.currentTarget&&$()},T=()=>{c.value=c.value===0?360-X:c.value-X},h=()=>{c.value=(c.value+X)%360},P=()=>{k("zoomIn")},V=()=>{k("zoomOut")},ee=()=>{_(),L()};return(w,R)=>(y(),Z(ae,{to:l.value,disabled:!l.value},[m(ne,{name:"preview-fade"},{default:x(()=>[r.value?K((y(),I("div",{key:0,ref_key:"wrapperRef",ref:i,class:v(o(n)()),style:S(O.value)},[u("div",{class:v(o(n)("mask")),onClick:z},null,2),u("div",{class:v(o(n)("body")),style:S({transform:`scale(${o(f)}, ${o(f)})`}),onClick:z},[u("img",{ref_key:"imageRef",ref:p,src:e.src,class:v(o(n)("img")),style:S({transform:`rotate(${c.value}deg) translate(${o(d)[0]}px, ${o(d)[1]}px)`})},null,14,Ie)],6),e.closable?(y(),I("button",{key:0,class:v(o(n)("close-btn")),onClick:$},[m(o(oe))],2)):C("",!0),e.previewGroup?(y(),I(A,{key:1},[u("button",{class:v(o(n)("arrow-left")),style:S({zIndex:o(M).nextIndex()}),onClick:R[0]||(R[0]=te=>a("onPrev"))},[m(o(ce))],6),u("button",{class:v(o(n)("arrow-right")),style:S({zIndex:o(M).nextIndex()}),onClick:R[1]||(R[1]=te=>a("onNext"))},[m(o(ue))],6)],64)):C("",!0),u("div",{class:v(o(n)("toolbar")),style:S({zIndex:o(M).nextIndex()})},[m(o(Y),{placement:"top",title:"向左旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:T},[m(o(de))],2)]),_:1}),m(o(Y),{placement:"top",title:"向右旋转","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:h},[m(o(ve))],2)]),_:1}),m(o(Y),{placement:"top",title:"放大","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:P},[m(o(pe))],2)]),_:1}),m(o(Y),{placement:"top",title:"缩小","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),onClick:V},[m(o(me))],2)]),_:1}),m(o(Y),{placement:"top",title:"原始比例","close-delay":0},{default:x(()=>[u("button",{class:v(o(n)("toolbar-btn")),style:{width:"50px"},onClick:ee},[u("span",null,N(o(be)(o(f))),1)],2)]),_:1})],6)],6)),[[se,e.visible]]):C("",!0)]),_:1})],8,["to","disabled"]))}}),Le=["src"],xe={class:"icon"},Se={key:0,class:"alt"},Ee={class:"title"},Oe={class:"description"},$e=G({name:"YkImage",__name:"image",props:{src:{},width:{},height:{},title:{},alt:{},description:{},footerPosition:{default:"inner"},isLazy:{type:Boolean,default:!1},fit:{},preview:{type:Boolean,default:!0},popupContainer:{},onCancel:{}},setup(s){const t=s,e=H("image"),a=b(!1),n=b(),{isLoaded:r,isError:c,isLoading:p,setLoadStatus:i}=we(),f=g(()=>[e(),{[`${e("with-error")}`]:c.value,[`${e("with-loading")}`]:p.value}]),_=g(()=>[e("footer",[t.footerPosition])]),k=g(()=>ge(t,["width","height","title","alt"])),d=g(()=>t.fit?{objectFit:t.fit}:{}),L=g(()=>({width:W(t.width),height:l.value?void 0:W(t.height)})),l=g(()=>t.title||t.description),E=b(!1),O=h=>{t.isLazy?!n.value&&h&&(n.value=t.src):n.value=t.src,E.value=h};B(()=>t.src,h=>{i("loading"),E.value&&(n.value=h),t.isLazy&&!E.value&&(n.value="")});const $=()=>i("loaded"),z=()=>i("error"),T=()=>{t.preview&&(a.value=!0)};return J(()=>{i("loading")}),(h,P)=>K((y(),I("div",{class:v(f.value),style:S(L.value)},[u("img",le({class:o(e)("img"),style:d.value,src:n.value},k.value,{onLoad:$,onError:z,onClick:T}),null,16,Le),o(r)?C("",!0):(y(),I("div",{key:0,class:v(o(e)("overlay-container"))},[o(c)?D(h.$slots,"error",{key:0},()=>[u("div",{class:v(o(e)("overlay",["error"]))},[u("div",xe,[D(h.$slots,"error-icon",{},()=>[m(o(fe))])]),t.alt?(y(),I("div",Se,N(t.alt),1)):C("",!0)],2)]):C("",!0),o(p)?D(h.$slots,"loading",{key:1},()=>[u("div",{class:v(o(e)("overlay",["loading"]))},null,2)]):C("",!0)],2)),l.value?(y(),I("div",{key:1,class:v(_.value)},[u("div",null,[u("div",Ee,N(t.title),1),u("div",Oe,N(t.description),1)]),u("div",null,[D(h.$slots,"extra")])],2)):C("",!0),m(Q,{visible:a.value,"onUpdate:visible":P[0]||(P[0]=V=>a.value=V),src:t.src,"popup-container":t.popupContainer,onCancel:t.onCancel},null,8,["visible","src","popup-container","onCancel"])],6)),[[o(he),O]])}}),j=(s,t,e)=>{const a=b(s);return s!==void 0?a.value=s:a.value=t,[a,r=>{a.value=r,e==null||e(r)}]},Be=G({name:"YkImageGroup",__name:"preview-group",props:{visible:{type:Boolean},current:{default:0},srcList:{},width:{},height:{},defaultCurrent:{default:0},isRender:{type:Boolean,default:!0},closable:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},fit:{},onCancel:{}},emits:["update:visible","update:current"],setup(s,{emit:t}){const e=s,a=t,[n,r]=j(e.defaultCurrent,e.current,l=>a("update:current",l)),[c,p]=j(e.visible,!1,l=>a("update:visible",l)),i=g(()=>{var l;return(l=e.srcList)==null?void 0:l.length}),f=g(()=>{if(e.srcList&&e.srcList.length)return e.srcList[n.value]});B(()=>e.visible,l=>p(l)),B(()=>e.current,l=>r(l));const _=l=>{r(l),p(!0)},k=()=>{var l;p(!1),(l=e.onCancel)==null||l.call(e)},d=()=>{i.value&&(n.value>=i.value-1?n.value=0:n.value++)},L=()=>{i.value&&(n.value<=0?n.value=i.value-1:n.value--)};return(l,E)=>(y(),I(A,null,[e.isRender?(y(),Z(o(ie),{key:0},{default:x(()=>[(y(!0),I(A,null,re(e.srcList,(O,$)=>(y(),Z(o(Ye),{key:O,src:O,width:e.width,height:e.height,preview:!1,fit:e.fit,onClick:()=>_($)},null,8,["src","width","height","fit","onClick"]))),128))]),_:1})):C("",!0),m(o(ze),{visible:o(c),src:f.value,closable:e.closable,"mask-closable":e.maskClosable,"preview-group":"",onOnNext:d,onOnPrev:L,onCancel:k},null,8,["visible","src","closable","mask-closable"])],64))}}),Ye=F($e),ze=F(Q),Te=F(Be);export{Te as Y,Ye as a,ze as b};
